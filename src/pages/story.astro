---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import en from '../i18n/en.json';
import zh from '../i18n/zh.json';
const base = import.meta.env.BASE_URL;
---

<Layout title="Our Story | Kevin & Sophie">
  <Navigation currentPage="story" />
  <main class="page-content">
    <section class="story-hero">
      <div class="container">
        <h1 class="page-title animate-fade-in">
          <span data-lang-en>{en.story.title}</span>
          <span data-lang-zh style="display: none;">{zh.story.title}</span>
        </h1>
        <p class="page-subtitle animate-fade-in" style="animation-delay: 0.2s;">
          <span data-lang-en>{en.story.subtitle}</span>
          <span data-lang-zh style="display: none;">{zh.story.subtitle}</span>
        </p>
      </div>
    </section>

    <section class="story-timeline section">
      <div class="container">
        {en.story.content.map((item, index) => (
          <article
            class="timeline-item"
            data-animate={index % 2 === 0 ? "left" : "right"}
          >
            <div class="timeline-photo">
              {index === 0 ? (
                <div class="photo-actual">
                  <img src={`${base}/images/first.jpg`} alt="Our first date" />
                </div>
              ) : index === 1 ? (
                <div class="photo-actual">
                  <img src={`${base}/images/minecraft.PNG`} alt="Our Minecraft adventures" />
                </div>
              ) : index === 2 ? (
                <div class="photo-actual photo-proposal">
                  <img src={`${base}/images/proposal.jpg`} alt="The proposal" />
                </div>
              ) : (
                <div class="photo-actual photo-love">
                  <img src={`${base}/images/love.jpeg`} alt="Our future together" />
                </div>
              )}
            </div>
            <div class="timeline-connector">
              <span class="timeline-dot"></span>
              <span class="timeline-line"></span>
            </div>
            <div class="timeline-content">
              <span class="timeline-number">{index + 1}</span>
              <div class="story-avatar">
                {item.voice === 'kevin' ? (
                  <span class="avatar avatar-kevin">K</span>
                ) : item.voice === 'sophie' ? (
                  <span class="avatar avatar-sophie">S</span>
                ) : (
                  <>
                    <span class="avatar avatar-kevin">K</span>
                    <span class="avatar avatar-sophie">S</span>
                  </>
                )}
              </div>
              <h3 class="timeline-title">
                <span data-lang-en>{item.title}</span>
                <span data-lang-zh style="display: none;">{zh.story.content[index].title}</span>
              </h3>
              <p class="timeline-text">
                <span data-lang-en>{item.text}</span>
                <span data-lang-zh style="display: none;">{zh.story.content[index].text}</span>
              </p>
            </div>
          </article>
        ))}
      </div>
    </section>

    <section class="story-cta section-ivory">
      <div class="container text-center">
        <p class="cta-text" data-animate>
          <span data-lang-en>Join us as we begin this new chapter</span>
          <span data-lang-zh style="display: none;">与我们一起开启新的篇章</span>
        </p>
        <a href={`${base}/rsvp`} class="btn btn-primary" data-animate>
          <span data-lang-en>RSVP Now</span>
          <span data-lang-zh style="display: none;">立即回复</span>
        </a>
      </div>
    </section>
  </main>
  <Footer />
</Layout>

<style>
  .story-hero {
    padding-top: calc(80px + var(--space-16));
    padding-bottom: var(--space-12);
    background-color: var(--color-ivory);
    text-align: center;
  }

  .page-title {
    font-family: var(--font-serif);
    font-size: var(--text-5xl);
    font-weight: 400;
    color: var(--color-charcoal);
    margin-bottom: var(--space-4);
  }

  .page-subtitle {
    font-family: var(--font-serif);
    font-size: var(--text-xl);
    font-style: italic;
    color: var(--color-gray);
  }

  .story-timeline {
    padding: var(--space-16) 0;
  }

  .timeline-item {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    gap: var(--space-8);
    margin-bottom: var(--space-16);
    align-items: center;
  }

  .timeline-item:last-child {
    margin-bottom: 0;
  }

  .timeline-item:nth-child(even) {
    direction: rtl;
  }

  .timeline-item:nth-child(even) > * {
    direction: ltr;
  }

  .timeline-photo {
    display: flex;
    justify-content: flex-end;
  }

  .timeline-item:nth-child(even) .timeline-photo {
    justify-content: flex-start;
  }

  .photo-placeholder {
    width: 280px;
    height: 280px;
    background-color: var(--color-ivory);
    border-radius: var(--radius-lg);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    border: 2px dashed var(--color-gray-light);
  }

  .photo-icon {
    font-size: 2.5rem;
    opacity: 0.5;
  }

  .photo-text {
    font-size: var(--text-sm);
    color: var(--color-gray);
    text-transform: uppercase;
    letter-spacing: 0.1em;
  }

  .photo-actual {
    width: 280px;
    height: 280px;
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-base);
  }

  .photo-actual img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .photo-proposal img {
    transform: scale(1.1);
  }

  .photo-love img {
    object-position: right center;
    transform: scale(1.1);
  }

  /* Minecraft photo styling */
  .photo-minecraft {
    border: 4px solid var(--color-sage);
    border-radius: 4px;
    background: linear-gradient(135deg, #5d8a4c 0%, #3d6b34 100%);
  }

  .photo-minecraft .photo-icon {
    opacity: 0.8;
    color: var(--color-white);
  }

  .photo-minecraft .photo-text {
    color: var(--color-white);
    opacity: 0.9;
  }

  /* Future/upcoming photo styling */
  .photo-future {
    background: linear-gradient(135deg, var(--color-sage-light) 0%, var(--color-sage) 100%);
    border: none;
  }

  .photo-future .photo-icon {
    opacity: 0.9;
    color: var(--color-white);
    font-size: 3rem;
  }

  .photo-future .photo-text {
    color: var(--color-white);
    opacity: 0.9;
  }

  .timeline-connector {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0;
  }

  .timeline-dot {
    width: 16px;
    height: 16px;
    background-color: var(--color-sage);
    border-radius: 4px; /* Minecraft-inspired blocky dot */
    flex-shrink: 0;
  }

  .timeline-line {
    width: 2px;
    height: 100%;
    min-height: 200px;
    background: linear-gradient(180deg, var(--color-sage), var(--color-sage-light));
  }

  .timeline-item:last-child .timeline-line {
    display: none;
  }

  .timeline-content {
    background-color: var(--color-white);
    padding: var(--space-8);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-base);
    position: relative;
    max-width: 400px;
  }

  .timeline-number {
    position: absolute;
    top: var(--space-4);
    right: var(--space-4);
    font-family: var(--font-serif);
    font-size: var(--text-4xl);
    color: var(--color-sage-light);
    opacity: 0.3;
    font-weight: 300;
  }

  .story-avatar {
    display: flex;
    gap: var(--space-2);
    margin-bottom: var(--space-3);
  }

  .avatar {
    width: 36px;
    height: 36px;
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: var(--font-serif);
    font-size: var(--text-base);
    font-weight: 500;
    color: var(--color-white);
  }

  .avatar-kevin {
    background-color: var(--color-sage);
  }

  .avatar-sophie {
    background-color: #c4a4a4;
  }

  .timeline-title {
    font-family: var(--font-serif);
    font-size: var(--text-2xl);
    color: var(--color-charcoal);
    margin-bottom: var(--space-4);
    font-weight: 500;
  }

  .timeline-text {
    font-family: var(--font-sans);
    color: var(--color-gray);
    line-height: 1.8;
  }

  .story-cta {
    padding: var(--space-16) 0;
  }

  .cta-text {
    font-family: var(--font-serif);
    font-size: var(--text-2xl);
    font-style: italic;
    color: var(--color-charcoal);
    margin-bottom: var(--space-6);
  }

  /* Responsive */
  @media (max-width: 900px) {
    .timeline-item {
      grid-template-columns: auto 1fr;
      gap: var(--space-6);
    }

    .timeline-item:nth-child(even) {
      direction: ltr;
    }

    .timeline-photo {
      display: none;
    }

    .timeline-content {
      max-width: none;
    }
  }

  @media (max-width: 600px) {
    .page-title {
      font-size: var(--text-4xl);
    }

    .timeline-content {
      padding: var(--space-6);
    }
  }
</style>
